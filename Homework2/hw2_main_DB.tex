\documentclass[]{article}

% include Packages
%\usepackage{pdfpages}
\usepackage{amsmath,amssymb}
\usepackage{amsthm}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{float}

% Formatting text ranges
\setlength{\textwidth}{450pt}
\setlength{\textheight}{685pt}
\setlength{\topmargin}{-40pt}
\setlength{\hoffset}{-15mm}

% Define Theorem environments
\newtheorem{theorem}{Theorem}
\newtheorem*{theorem*}{Theorem} % allow not enumerated theorems
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}

% Define custom commands
\newcommand{\yopt}{y^*}
\newcommand{\todo}{{\color{red} TODO!}}
\newcommand{\ind}[2]{{#1}_{\mathrm{#2}}}
\newcommand{\trp}{^T}
\newcommand{\fx}{f(x)}
\newcommand{\fsigx}{f(\sigma x)}
\newcommand{\fxtrp}{f \trp (x)}
\newcommand{\xone}{x_1}
\newcommand{\xtwo}{x_2}
\newcommand{\dotx}{\dot x}
\newcommand{\dotxone}{\dotx_1}
\newcommand{\dotxtwo}{\dotx_2}
\newcommand{\Rn}{\mathbb{R}^n}
\newcommand{\Nset}{\mathbb{N}}
\newcommand{\forntoinf}{\overset{n \rightarrow \infty}{\longrightarrow}}
\newcommand{\jacf}{\dfrac{\partial }{\partial x} \fx}
\renewcommand{\brack}[1]{\left[ #1 \right]}
\newcommand{\parenth}[1]{\left( #1 \right)}
\newcommand{\jacfbrack}{\brack{\jacf}}
\newcommand{\matleq}{\preccurlyeq}
\newcommand{\norm}[1]{\parallel \! \! #1 \! \! \parallel}
\newcommand{\partialx}{\frac{\partial}{\partial x}}
\newcommand{\dsig}{\mathrm{d} \sigma}
\newcommand{\intsigma}{\int_{0}^{1} \partialx \fsigx x \dsig}
\newcommand{\Qx}{Q(x)}
\newcommand{\Vx}{V(x)}
\newcommand{\xtrp}{x \trp}
\newcommand{\gammaxsig}{\gamma(x,\sigma)}
\newcommand{\xn}{x_n}
\newcommand{\xnull}{x_0}
\newcommand{\unull}{u_0}
\newcommand{\xN}{x_N}
\newcommand{\xk}{x_k}
\newcommand{\uk}{u_k}
\newcommand{\xtrpn}{x_n \trp}
\newcommand{\fxn}{f(\xn)}
\newcommand{\dotVx}{\dot{V}(x)}
\newcommand{\dVdtx}{\frac{\mathrm{d} V(x)}{\mathrm{d} t}}
\newcommand{\partialVx}{\frac{\partial V(x)} {\partial x}}
\newcommand{\matricks}[4]{\begin{pmatrix}#1 & #2 \\ #3 & #4 \end{pmatrix}}
\newcommand{\twovector}[2]{\begin{pmatrix}{ #1 }\\{ #2 }\end{pmatrix}}
\newcommand{\Ad}{A_d}
\newcommand{\Bd}{B_d}
\newcommand{\xkplus}{x_{k+1}}
%\newcommand{\dotx}{\dot{x}}
\newcommand{\tk}{t_{k}}
\newcommand{\tkplus}{t_{k+1}}
\newcommand{\Aeul}{\ind{A}{eul}}
\newcommand{\Beul}{\ind{B}{eul}}
\newcommand{\optmin}{\mathrm{min}.}
\newcommand{\Aeq}{\ind{A}{eq}}
\newcommand{\beq}{\ind{b}{eq}}
\newcommand{\Aeqx}{\Aeq^x}
\newcommand{\Aequ}{\Aeq^u}
\newcommand{\Aineq}{\ind{A}{{  in}}}
\newcommand{\bineq}{\ind{b}{{  in}}}
\newcommand{\xbar}{\bar{x}}
\newcommand{\xtilde}{\tilde{x}}
\newcommand{\vectorthree}[3]{\begin{pmatrix}
		#1 \\ #2 \\ #3
\end{pmatrix}}
\newcommand{\vectortwo}[2]{\begin{pmatrix}
		#1 \\ #2
\end{pmatrix}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\grad}{\nabla}
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
%\newcommand{\Rn}{\mathbb{R}^n}
\newcommand{\Rm}{\mathbb{R}^m}
\newcommand{\Rp}{\mathbb{R}^p}
\newcommand{\Fx}{F(x)}
\newcommand{\jac}{J}
\newcommand{\jacF}{\jac F}
\newcommand{\inv}{^{-1}}
\newcommand{\fnull}{f_0}
\newcommand{\X}{\mathcal{X}}
\newcommand{\U}{\mathcal{U}}
\newcommand{\writeset}[1]{\{#1\}}
\newcommand{\Vk}{V_k}
\newcommand{\Vopt}{\Vind{*}}
\newcommand{\Vind}[1]{V^#1}
\newcommand{\Vone}{\Vind{1}}
\newcommand{\Vtwo}{\Vind{2}}
\newcommand{\Vzero}{\Vind{0}}
\newcommand{\Vnull}{\Vind{0}}
\newcommand{\Vkplus}{V_{k+1}}
\newcommand{\minVit}[6]{\min_{u \in \U} \writeset{#1+0.9\Vk(\xi_{#2}), #3+0.9\Vk(\xi_{#4}),#5+0.9\Vk(\xi_#6) }}
%opening
\title{Optimal Control WS20/21: Homework 2}
\author{Daniel Bergmann}

\begin{document}

\maketitle

\subsection*{Problem 1}
		\begin{enumerate}
			\item[a)] Formulating the problem as an discrete-time, infinite-horizon o. c. problem yields
				\begin{equation}
				\begin{aligned}
				& \underset{u_0,u_1,\dots}{\text{min.}}
				& & \sum_{k=0}^{\infty} \fnull(\xk,\uk) =  0.9^k \fnull(\xk,\uk)\\
				& \text{subject to}
				& & \xkplus = f(\xk,\uk),\\
				& & & \xk \in \X = \writeset{\xi_1,\dots,\xi_8},\\
				& & & \uk \in \U = \writeset{0,1,2},\\
				& & &\xnull = \xi_1,\\ 
				\end{aligned}
				\end{equation}
				where the dynamics $ f: \X \times \U \longrightarrow \X $ are defined by the arrows in the graph.
				
				The Value function iteration is defined by the Bellman operator
				\begin{equation} \label{eq:BellmanOp}
					\Vkplus(x) = T\Vk(x) = \underset{u \in \U}{\min} \writeset{\fnull(x,u) + \alpha \Vk(x)}  \quad \text{with} \quad \alpha= 0.9.
				\end{equation}
				Evaluated for this particular problem, this yields
				\begin{align}
					\begin{split}
						\Vkplus(\xi_1) &= \min_{u \in \U} \writeset{1+0.9 \Vk(\xi_2),1+0.9\Vk(\xi_2)},\\
						\Vkplus(\xi_2) &= \min_{u \in \U} \writeset{3+0.9 \Vk(\xi_7),6+0.9\Vk(\xi_5),3+0.9\Vk(\xi_4)},\\
						\Vkplus(\xi_3) &= \min_{u \in \U} \writeset{1+0.9\Vk(\xi_4), 2+0.9\Vk(\xi_6),3+0.9\Vk(\xi_5) },\\
						\Vkplus(\xi_4) &= \minVit{2}{7}{6}{8}{3}{6},\\
						\Vkplus(\xi_5) &= \minVit{0}{4}{0}{4}{1}{6},\\
						\Vkplus(\xi_6) &= \minVit{5}{1}{1}{7}{1}{8},\\
						\Vkplus(\xi_7) &= \minVit{2}{8}{2}{8}{2}{8},\\
						\Vkplus(\xi_8) &= \minVit{0}{8}{0}{8}{0}{8},
					\end{split}
				\end{align}
				starting with an arbitrary inital value function $ \Vnull: \X \longrightarrow \R $.
			\item[b)]
				Matlab Results \todo
			
			\item[c)] We suppose
			\begin{equation}
				\Vnull(\xi) \leq T\Vnull(\xi) \quad \forall_{\xi \in \X} \label{eq:InitAssumption},
			\end{equation}
			for an initial function $ \Vnull $ for a value function iteration with the Bellman Operator, defined in \eqref{eq:BellmanOp}.
			From the lectures, we have the following properties.
			\begin{align}
				\norm{T\Vone - T\Vtwo}_\infty &\leq \alpha \norm{\Vone - \Vtwo}_\infty \quad &\text{(Contraction)} \label{eq:contraction}\\
				\Vone(\xi) &\leq \Vtwo(\xi) \quad \forall_{\xi \in \X} \Longrightarrow T\Vone(\xi) \leq T\Vtwo(\xi) \quad \forall_{\xi \in \X} \quad &\text{(Monotonicity)} \label{eq:monotonicity}\\
				\Vopt \text{ solves the Bellman Equation }&  \Vopt \text{ is the Value function, since we have discounted costs.} \label{eq:sufficientBE}
			\end{align}
			First we show, that the iteration converges to the value function of the problem. Since \eqref{eq:contraction} holds and   $ \alpha \in (0,1) $,we deduce the convergence of  $ \writeset{\Vk}_{k \in \N} $ by the Banach-Fixed-Point-Theorem. Since we have such a limit $ \lim\limits_{k \rightarrow \infty} \Vk \longrightarrow \Vopt $, it has to satisfy the fixed point property $ T\Vopt = \Vopt $. Hence it satisfies the Bellman equation and \eqref{eq:sufficientBE} verifies $ \Vopt $ as the value function of our problem.
			
			Second, it remains to show that $ \Vnull(\xi) \leq \Vopt(\xi) \forall_{\xi \in \X} $ holds.\\
			By assumption \eqref{eq:InitAssumption} and the monotonicity property \eqref{eq:monotonicity}, we infer inductively, that $ \Vk(\xi) \leq \Vkplus(\xi) $ for all $ \xi \in \X $. Thus, the sequence $ \writeset{\Vk(\xi)}_{k\in \N_0} $ is non-decreasing for any $ \xi \in \X $. This proves the claim $ \Vnull(\xi) \leq \Vopt(\xi) \forall_{\xi \in \X } $.
			
			
			
			
		\end{enumerate} 
\subsection*{Problem 2}
		\begin{enumerate}
			\item[a)]
			\item[b)]
		\end{enumerate}	
\end{document}
